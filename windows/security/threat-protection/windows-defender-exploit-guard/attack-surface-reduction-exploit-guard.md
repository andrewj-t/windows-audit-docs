---
title: Use attack surface reduction rules to prevent malware infection
description: Attack surface reduction rules can help prevent exploits from using apps and scripts to infect machines with malware
keywords: Attack surface reduction, hips, host intrusion prevention system, protection rules, anti-exploit, antiexploit, exploit, infection prevention
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: w10
ms.mktglfcycl: manage
ms.sitesec: library
ms.pagetype: security
ms.localizationpriority: medium
author: andreabichsel
ms.author: v-anbic
---

# Reduce attack surfaces with attack surface reduction rules 

**Applies to:**

- [Windows Defender Advanced Threat Protection (Windows Defender ATP)](https://wincom.blob.core.windows.net/documents/Windows10_Commercial_Comparison.pdf)

Attack surface reduction rules help prevent malware from using actions and apps to infect computers with malicious code. You can set attack surface reduction rules for computers running Windows 10 or Windows Server 2019. 

To use attack surface reduction rules, you need either a Windows 10 Enterprise E3 or E5 license. We recommend an E5 license so you can take advantage of the advanced monitoring and reporting capabilities available in [Windows Defender Advanced Threat Protection](../windows-defender-atp/windows-defender-advanced-threat-protection.md).

With an E3 license, you won't have these advanced capabilities, but you can develop your own monitoring and reporting tools to use in conjunction with attack surface reduction rules.

Attack surface reduction rules target specific behaviors that malware and malicious apps typically use to infect computers, including:

- Executable files and scripts used in Office apps or web mail that attempt to download or run files
- Obfuscated or otherwise suspicious scripts
- Behaviors that apps don't usually initiate during normal day-to-day work

Triggered rules display a notification. You can [customize the notification](customize-attack-surface-reduction.md#customize-the-notification) with your company details and contact information.

You can set attack surface reduction rules in [audit mode](audit-windows-defender-exploit-guard.md) to evaluate how they'd impact your organization once enabled.

For information about configuring attack surface reduction rules, see [Enable attack surface reduction rules](enable-attack-surface-reduction.md).

## Attack surface reduction rules

The following sections describe each attack surface reduction rule. This table shows their corresponding GUIDs, which you use if you're configuring the rules with Group Policy:

Rule name | GUID
-|-
Block executable content from email client and webmail | BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550
Block all Office applications from creating child processes | D4F940AB-401B-4EFC-AADC-AD5F3C50688A
Block Office applications from creating executable content  | 3B576869-A4EC-4529-8536-B80A7769E899
Block Office applications from injecting code into other processes | 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84
Block JavaScript or VBScript from launching downloaded executable content | D3E037E1-3EB8-44C8-A917-57927947596D
Block execution of potentially obfuscated scripts  | 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC
Block Win32 API calls from Office macro | 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B
Block executable files from running unless they meet a prevalence, age, or trusted list criteria | 01443614-cd74-433a-b99e-2ecdc07bfc25
Use advanced protection against ransomware | c1db55ab-c21a-4637-bb3f-a12568109d35
Block credential stealing from the Windows local security authority subsystem (lsass.exe) | 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2
Block process creations originating from PSExec and WMI commands | d1e49aac-8f56-4280-b9ba-993a6d77406c
Block untrusted and unsigned processes that run from USB | b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4
Block Office communication application from creating child processes | 26190899-1602-49e8-8b27-eb1d0a1ce869
Block Adobe Reader from creating child processes | 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c

In general, attack surface reduction rules apply to the following Office apps:

- Microsoft Word
- Microsoft Excel
- Microsoft PowerPoint
- Microsoft OneNote

Except where specified, attack surface reduction rules don't apply to any other Office apps.

### Block executable content from email client and webmail

This rule blocks the following file types from launching from email in Microsoft Outlook or webmail (such as Gmail.com or Outlook.com):

- Executable files (such as .exe, .dll, or .scr) 
- Script files (such as a PowerShell .ps, VisualBasic .vbs, or JavaScript .js file)
- Script archive files

Intune name: Execution of executable content (exe, dll, ps, js, vbs, etc.) dropped from email (webmail/mail client) (no exceptions)

SCCM name: Block executable content from email client and webmail

GUID: BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550

### Block all Office applications from creating child processes

This rule blocks Office apps from creating child processes. This includes Word, Excel, PowerPoint, OneNote, and Access.

This is a typical malware behavior, especially for macro-based attacks that attempt to use Office apps to launch or download malicious executables.

Intune name: Office apps launching child processes

SCCM name: Block Office application from creating child processes

GUID: D4F940AB-401B-4EFC-AADC-AD5F3C50688A

### Block Office applications from creating executable content

This rule targets typical behaviors used by suspicious and malicious add-ons and scripts (extensions) that create or launch executable files. This is a typical malware technique.

Office apps won't be able to use extensions. Typically, these extensions use the Windows Scripting Host (.wsh files) to run scripts that automate certain tasks or provide user-created add-on features.

Intune name: Office apps/macros creating executable content

SCCM name: Block Office applications from creating executable content

GUID: 3B576869-A4EC-4529-8536-B80A7769E899

### Block Office applications from injecting code into other processes

This rule prevents Office apps, including Word, Excel, or PowerPoint, from injecting code into other processes. 

This helps prevent attacks where malware runs malicious code in an attempt to hide the activity from antivirus scanning engines.

Intune name: Office apps injecting code into other processes (no exceptions)

SCCM name: Block Office applications from injecting code into other processes

GUID: 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84

### Block JavaScript or VBScript From launching downloaded executable content

Malware often uses JavaScript and VBScript scripts to launch other malicious apps. 

This rule prevents these scripts from launching apps, helping to prevent malicious use of the scripts to spread malware and infect machines.

>[!IMPORTANT]
>File and folder exclusions don't apply to this attack surface reduction rule.

Intune name: js/vbs executing payload downloaded from Internet (no exceptions)

SCCM name: Block JavaScript or VBScript from launching downloaded executable content

GUID: D3E037E1-3EB8-44C8-A917-57927947596D

### Block execution of potentially obfuscated scripts

Malware and other threats can attempt to obfuscate or hide their malicious code in some script files. 

This rule prevents potentially obfuscated scripts from running. 

Intune name: Obfuscated js/vbs/ps/macro code

SCCM name: Block execution of potentially obfuscated scripts.

GUID: 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC

### Block Win32 API calls from Office macro

Malware can use macro code in Office files to import and load Win32 DLLs, which the malware then uses to make API calls to allow further infection throughout the system.

This rule attempts to block Office files that contain macro code that can import Win32 DLLs. This includes Word, Excel, PowerPoint, and OneNote.

Intune name: Win32 imports from Office macro code

SCCM name: Block Win32 API calls from Office macros

GUID: 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B

### Block executable files from running unless they meet a prevalence, age, or trusted list criteria
 
This rule blocks the following file types from launching unless they either meet prevalence or age criteria set by admins, or they're in a trusted list or exclusion list:
 
- Executable files (such as .exe, .dll, or .scr) 

>[!NOTE]
>You must [enable cloud-delivered protection](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/enable-cloud-protection-windows-defender-antivirus) to use this rule.

Intune name: Executables that don't meet a prevalence, age, or trusted list criteria

SCCM name: Block executable files from running unless they meet a prevalence, age, or trusted list criteria

GUID: 01443614-cd74-433a-b99e-2ecdc07bfc25
 
### Use advanced protection against ransomware
 
This rule provides an extra layer of protection against ransomware. It scans executable files entering the system to determine whether they're trustworthy. If the files closely resemble ransomware, this rule blocks them from running, unless they're in a trusted list or exclusion list.

>[!NOTE]
>You must [enable cloud-delivered protection](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/enable-cloud-protection-windows-defender-antivirus) to use this rule.

Intune name: Advanced ransomware protection

SCCM name: Use advanced protection against ransomware

GUID: c1db55ab-c21a-4637-bb3f-a12568109d35
 
### Block credential stealing from the Windows local security authority subsystem (lsass.exe)
 
Local Security Authority Subsystem Service (LSASS) authenticates users who log in to a Windows computer. Windows Defender Credential Guard in Windows 10 normally prevents attempts to extract credentials from LSASS. However, some organizations can't enable Credential Guard on all of their computers because of compatibility issues with custom smartcard drivers or other programs that load into the Local Security Authority (LSA). In these cases, attackers can use tools like Mimikatz to scrape cleartext passwords and NTLM hashes from LSASS. This rule helps mitigate that risk by locking down LSASS.

 >[!NOTE]
 >The coding in some apps enumerate all running processes and attempt opening them with exhaustive permissions. This causes the app to access LSASS even when it's not necessary. This rule denies the app's process open action and logs the details to the security event log. By itself, this event log entry doesn't necessarily indicate a malicious threat.

Intune name: Flag credential stealing from the Windows local security authority subsystem

SCCM name: Block credential stealing from the Windows local security authority subsystem

GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2

### Block process creations originating from PSExec and WMI commands
 
This rule blocks processes through PsExec and WMI commands from running, to prevent remote code execution that can spread malware attacks.

>[!IMPORTANT]
>File and folder exclusions do not apply to this attack surface reduction rule.

>[!WARNING]
>Only use this rule if you're managing your devices with [Intune](https://docs.microsoft.com/intune) or another MDM solution. This rule is incompatible with management through [System Center Configuration Manager](https://docs.microsoft.com/sccm) because this rule blocks WMI commands the SCCM client uses to function correctly.

Intune name: Process creation from PSExec and WMI commands

SCCM name: Not applicable

GUID: d1e49aac-8f56-4280-b9ba-993a6d77406c
 
### Block untrusted and unsigned processes that run from USB
 
With this rule, admins can prevent unsigned or untrusted executable files from running from USB removable drives, including SD cards. Blocked file types include:
 
- Executable files (such as .exe, .dll, or .scr) 
- Script files (such as a PowerShell .ps, VisualBasic .vbs, or JavaScript .js file)

Intune name: Untrusted and unsigned processes that run from USB

SCCM name: Block untrusted and unsigned processes that run from USB

GUID: b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4

### Block Office communication application from creating child processes

This rule prevents Outlook from creating child processes, including launching an app when a user double-clicks an attachment. 

This is a typical malware behavior, especially for macro-based attacks that attempt to use Outlook to launch or download malicious executables.

>[!NOTE]
>This rule applies to Outlook only.

Intune name: Not applicable

SCCM name: Not applicable

GUID: 26190899-1602-49e8-8b27-eb1d0a1ce869

### Block Adobe Reader from creating child processes

This rule blocks Adobe Reader from creating child processes.

This helps protect against heap-based buffer overflow vulnerabilities in PDF files, which attackers could use to launch malicious code. It also mitigates against potential JavaScript and Adobe Flash engine vulnerabilities that could allow attackers to insert and execute malicious code in PDF documents.

Intune name: Not applicable

SCCM name: Not applicable

GUID: 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c

## Related topics

- [Enable attack surface reduction rules](enable-attack-surface-reduction.md)
- [Evaluate attack surface reduction](evaluate-attack-surface-reduction.md)